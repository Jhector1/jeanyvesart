/* Theme hooks + fallbacks */
:root {
  --loader-overlay-bg: rgba(255, 255, 255, 0.65);
  --loader-accent: #{if(global-variable-exists(main-color), $main-color, #5664ab)};
  --loader-border: #{if(global-variable-exists(border-color-less-opacity), $border-color-less-opacity, rgba(112,128,144,.10))};
  --loader-shadow: 0 10px 40px rgba(0,0,0,.12);
}

.loader-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;

  background: var(--loader-overlay-bg);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  opacity: 1;
  visibility: visible;
  transition: opacity .35s ease, visibility .35s ease;
}

.loader-overlay.is-hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}

.loader-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: .875rem;

  min-width: 220px;
  padding: 1.25rem 1.5rem;
  border-radius: 1rem;
  background: #fff;
  border: 1px solid var(--loader-border);
  box-shadow: #{if(global-variable-exists(element-box-shadow), $element-box-shadow, var(--loader-shadow))};
}

.loader-ring {
  width: 64px; height: 64px;
  /* avoid pixel blur on transforms */
  shape-rendering: geometricPrecision;
}

.loader-ring .track {
  fill: none;
  stroke: rgba(0,0,0,.08);
  stroke-width: 4;
}

.loader-ring .indicator {
  fill: none;
  stroke: var(--loader-accent);
  stroke-width: 4;
  stroke-linecap: round;
  stroke-dasharray: 140;
  stroke-dashoffset: 140;
  transform-origin: 50% 50%;
  animation:
          loader-spin 1.2s linear infinite,
          loader-sweep 1.2s ease-in-out infinite;
}

@keyframes loader-spin { to { transform: rotate(360deg); } }
@keyframes loader-sweep {
  0%   { stroke-dashoffset: 140; }
  50%  { stroke-dashoffset: 35; }
  100% { stroke-dashoffset: 140; }
}

.loader-text {
  margin: .25rem 0 0;
  font-weight: 600;
  letter-spacing: .015em;
  color: #2a2a2a;
  text-align: center;
}

.loader-bar {
  width: 100%;
  height: 4px;
  border-radius: 999px;
  background: rgba(0,0,0,.08);
  overflow: hidden;
  position: relative;
}

.loader-bar .bar {
  position: absolute;
  inset-block: 0;
  width: 40%;
  transform: translateX(-100%);
  background: linear-gradient(90deg, transparent, var(--loader-accent), transparent);
  animation: loader-indeterminate 1.4s ease-in-out infinite;
}

@keyframes loader-indeterminate {
  0%   { transform: translateX(-100%); }
  50%  { transform: translateX(60%); }
  100% { transform: translateX(100%); }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .loader-ring .indicator { animation: loader-spin 1.2s linear infinite; }
  .loader-bar .bar { animation: none; transform: translateX(0); opacity: .25; width: 100%; }
}
